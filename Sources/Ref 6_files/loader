var _rely,_w=window,_d=document;if(void 0===_rely||void 0===_rely.def){void 0===_rely&&(_rely=[]),_rely.def=!0,_rely.timeout=2e3,_rely.postMessage=!0,_rely.ptc="https:"==_w.location.protocol?"https":"http",_rely.options=_rely.options?_rely.options:{},_rely.options.spa_autoreload=void 0===_rely.options.spa_autoreload||_rely.options.spa_autoreload,_rely.h="api.retargetly.com",_rely.x=encodeURIComponent,_rely.iframeCount=0,_rely.referer="",_rely.stack=[],_rely.stack.next=function(){if(this.gprc())return null;for(var e=0;e<this.length;e++)if(!this[e].sent)return this[e].sent=!0,this[e];return null},_rely.stack.gprc=function(){for(var e=0;e<this.length;e++)if(this[e].processing)return this[e];return null},_rely.callback=function(){var e=this.stack.gprc();e&&!e.processed&&(e.processing=!1,e.processed=!0,this.stack_call())},_rely.pts=function(e){if("pageview"!=e.type&&"formtags"!=e.type)for(var r=0;r<this.stack.length;r++)if(JSON.stringify(this.stack[r])==JSON.stringify(e))return!1;return this.stack.push(e),!0};try{var eventMethod=_w.addEventListener?"addEventListener":"attachEvent",eventer=_w[eventMethod],messageEvent="attachEvent"==eventMethod?"onmessage":"message";eventer(messageEvent,function(e){var r;e.origin==_rely.ptc.protocol+"//"+_rely.h&&(void 0===e.data||0<(r=(e.data+"").split("|")).length&&("ok"==r[0]?_rely.callback():"sg"==r[0]&&(_d.cookie="_rl_sg="+r[1]+"; path=/; expires="+new Date((new Date).getTime()+7776e6).toUTCString()+";")))},!1)}catch(e){_rely.postMessage=!1}_rely.get_client=function(e){for(var r in e)if("pid"==r)return e[r];return this.pid?this.pid:null},_rely.send=function(){var e,r,t,i=_rely,s={},l={},o=["tags","sec","gender","age","born","map","ml_sh5","ml_sh2","mb_sh5","mb_sh2","nid_sh5","nid_sh2","ml_raw","mb_raw","nid_raw","external_id"];if(void 0!==i&&void 0!==i.length&&0<(e=i.length))for(var _=0;_<e;_++){r=i[_];var n=this.get_client(r);if(n&&"object"==typeof r)for(t in r)-1!=o.indexOf(t)&&("map"==t?l[n]={id:this.x(r[t])}:(void 0===s[n]&&(s[n]={params:[]}),s[n].params.push(t+"="+this.x(r[t]))))}if(0<Object.keys(s).length)for(t in s)this.pts({pid:t,type:"data",value:s[t].params.join("&")});else!this.postMessage&&this.sic&&this.pid&&this.pts({type:"sic",pid:this.pid});if(0<Object.keys(s).length)for(t in l)this.pts({type:"map",pid:t,value:l[t].id});this.stack_call(),this.length=0},_rely.stack_call=function(){var e,r,t,i,s=this.stack.next();null!==s&&(e="script",t=r="",void 0!==_rely.options&&void 0!==_rely.options.limit_drop&&(t=_rely.options.limit_drop),"pageview"==s.type?(e="iframe",r=this.ptc+"://"+this.h+"/api?id="+s.pid+"&src="+s.s+"&url="+this.x(s.pv_obj.url)+"&browserUrl="+this.x(s.pv_obj.browserUrl)+"&ref="+this.x(s.pv_obj.referrer)+"&utmz="+this.x(s.pv_obj.utmz)+"&n="+this.x(s.pv_obj.title)+"&md="+this.x(s.pv_obj.description)+"&mk="+this.x(s.pv_obj.keywords)+"&il="+s.pv_obj.ilvl+"&limit_drop="+t):"data"==s.type?r=this.ptc+"://"+this.h+"/data?id="+s.pid+"&"+s.value:"formtags"==s.type?r=this.ptc+"://"+this.h+"/formtags?id="+s.pid:"sic"==s.type?r=this.ptc+"://"+this.h+"/cks?id="+s.pid:"map"==s.type&&(e="image",r=this.ptc+"://"+this.h+"/map?pid="+s.pid+"&mid="+s.value+"&rt=img&limit_drop="+t),""!=r&&(i=null,"iframe"==e?(this.iframeCount++,(i=_d.createElement("iframe")).setAttribute("id","rely-iframe-"+this.iframeCount),i.src=r,i.style.display="none"):"script"==e?(i=_d.createElement("script")).src=r:"image"==e&&((i=_d.createElement("img")).src=r),null!==i?(s.processing=!0,i.onload=function(){this.callback()}.bind(this),setTimeout(function(){this.callback()}.bind(this),_rely.timeout),_d.body.appendChild(i)):this.callback()))},_rely.pvo=function(){var e,r={},t=_w.parent!==_w.self?_w.parent===_w.top?1:2:0,i={ilvl:t,url:0==t?_d.location.href:1==t?_d.referrer:"",referrer:0==t?_d.referrer:"",title:0==t?_d.title:"",description:"",keywords:""};i.url=_rely.getUrl(i.url),i.browserUrl=_rely.browserUrl;try{r=_w.top.document,i.url=_d.top.location.href,i.referrer=r.referrer,i.title=r.title||""}catch(e){}this.referer&&(i.referrer=this.referer);for(var s=r.getElementsByTagName?r.getElementsByTagName("meta"):[],l=0;l<s.length;l++)"keywords"==s[l].name&&s[l].content?i.keywords=s[l].content.replace(/^\s+|\s+$/g,"").substr(0,100):"description"==s[l].name&&s[l].content&&(i.description=s[l].content.replace(/^\s+|\s+$/g,"").substr(0,300));return _d.cookie&&(e=_d.cookie.match(/.*__utmz=([^;]*)/))?i.utmz=e[1]:i.utmz="",i},_rely.oldURL=_d.location.href,_rely.udts=200,_rely.udact=!1,_rely.rpv=function(){this.spv(this.pvo())},_rely.udtc=function(){_rely.udact=!0;var e=_rely.getUrl(_d.location.href);_rely.oldURL!=e&&(_rely.rpid(),_rely.referer=_rely.oldURL,_rely.oldURL=e,_rely.rpv()),setTimeout(_rely.udtc,_rely.udts)},_rely.rpid=function(){for(var e=0;e<_rl_ids.length;e++)_rl_ids[e].processed=!1},_rely.spv=function(e){var r,t=0;if("undefined"!=typeof _rl_ids){_rely.rmrid();for(var i=0;i<_rl_ids.length;i++)_rl_ids[i].processed||(t=_rl_ids[i].pid,r=0,"number"==typeof _rl_ids[i].src&&(r=_rl_ids[i].src),t&&(_rely.pid=t,this.pts({type:"pageview",pid:t,s:r,pv_obj:e}),_rl_ids[i].processed=!0))}0!=this.stack.length&&(0<this.length&&this.send(),this.stack_call())},_rely.svid=function(){var e,r,t,i;"undefined"==typeof _rl_ids&&(_rl_ids=[]),"number"==typeof _rl_id&&99<_rl_id?(e=_rl_id,r=0,"number"==typeof _rl_src&&(r=_rl_src),_rl_ids.push({pid:e,src:r})):0!=_rl_ids.length||(i=(t=_d.getElementsByTagName("script"))[t.length-1].getAttribute("src",2))&&(e=i.match(/.*\?id=(\d\d\d+)/))&&_rl_ids.push({pid:e[1],src:0}),_rely.rmrid()},_rely.rmrid=function(){for(var e=_rl_ids.length-1;0<=e;e--)this.erid(_rl_ids[e].pid,_rl_ids[e].src,e)&&_rl_ids.splice(e)},_rely.erid=function(e,r,t){for(var i=0;i<_rl_ids.length;i++)if(i!=t&&_rl_ids[i].pid==e&&_rl_ids[i].src==r)return!0;return!1},_rely.reloadFormTags=function(){"object"==typeof _rl_ids&&"object"==typeof _rl_ids[0]&&_rl_ids[0].pid&&(this.pts({type:"formtags",pid:_rl_ids[0].pid}),this.stack_call())},_rely.getUrl=function(e){if(void 0!==_rely.options&&void 0!==_rely.options.url&&""!==_rely.options.url){if(/^(((H|h)(T|t)(T|t)(P|p)(S|s)?):\/\/)?[-a-zA-Z0-9@:%._\+~#=]{2,100}\.[a-zA-Z]{2,10}(\/([-a-zA-Z0-9@:%_\+.~#?&//=]*))?/.test(_rely.options.url))return _rely.browserUrl=_d.location.href,_rely.options.url;console.error("Invalid URL on option. It will be ignored.")}return e}}_rely.svid(),void 0!==_rely.options&&_rely.options.spa_autoreload&&!_rely.udact&&_rely.udtc(),_rely.rpv();